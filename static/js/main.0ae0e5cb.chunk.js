(this["webpackJsonpsocial-media-app"]=this["webpackJsonpsocial-media-app"]||[]).push([[0],{78:function(e,t,r){},87:function(e,t,r){"use strict";r.r(t);var n=r(0),c=r.n(n),a=r(11),s=r.n(a),i=(r(78),r(14)),o=r.n(i),l=r(18),u=r(12),j=r(7),b=r(64),d="https://posts-pw2021.herokuapp.com/api/v1",m={};m.login=function(){var e=Object(l.a)(o.a.mark((function e(t,r){var n,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d,"/auth/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:r})});case 2:if(!(n=e.sent).ok){e.next=8;break}return e.next=6,n.json();case 6:return c=e.sent,e.abrupt("return",c);case 8:return e.abrupt("return",{});case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),m.verifyToken=function(){var e=Object(l.a)(o.a.mark((function e(t){var r,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d,"/auth/whoami"),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});case 2:if(200!==(r=e.sent).status){e.next=8;break}return e.next=6,r.json();case 6:return n=e.sent,e.abrupt("return",n);case 8:return e.abrupt("return",{});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var x=m,p=r(2),O=c.a.createContext(),h="token",f=function(e){var t=Object(n.useState)(void 0),r=Object(u.a)(t,2),c=r[0],a=r[1],s=Object(n.useState)(void 0),i=Object(u.a)(s,2),j=i[0],d=i[1];Object(n.useEffect)((function(){var e=function(){var e=Object(l.a)(o.a.mark((function e(){var t,r,n,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=g())){e.next=8;break}return e.next=4,x.verifyToken(t);case 4:r=e.sent,n=r.username,c=r.role,n&&c&&(d({username:n,role:c}),m(t));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[c]);var m=function(e){localStorage.setItem(h,e),a(e)},f=Object(n.useCallback)((function(e,t){var r=function(){var r=Object(l.a)(o.a.mark((function r(){var n,c,a;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=!1,r.prev=1,r.next=4,x.login(e,t);case 4:c=r.sent,(a=c.token)&&(m(a),n=!0),r.next=13;break;case 9:r.prev=9,r.t0=r.catch(1),console.error(r.t0),console.error("Error in login");case 13:return r.prev=13,r.abrupt("return",n);case 16:case"end":return r.stop()}}),r,null,[[1,9,13,16]])})));return function(){return r.apply(this,arguments)}}();return r()}),[]),v=Object(n.useCallback)((function(){d(void 0),m(void 0)}),[]),w=Object(n.useMemo)((function(){return{token:c,user:j,login:f,logout:v}}),[c,j,f,v]);return Object(p.jsx)(O.Provider,Object(b.a)({value:w},e))},v=function(){var e=c.a.useContext(O);if(!e)throw new Error("useUserContext() must be inside of UserProvider");return e},g=function(){return localStorage.getItem(h)},w=r.p+"static/media/harbor.bee33a64.jpg",y=function(){var e=v(),t=e.login,r=e.token,c=Object(n.useState)(""),a=Object(u.a)(c,2),s=a[0],i=a[1],b=Object(n.useState)(""),d=Object(u.a)(b,2),m=d[0],x=d[1],O=Object(n.useState)(!1),h=Object(u.a)(O,2),f=h[0],g=h[1],y=Object(j.g)(),N=function(e,t){t(e.target.value)},k=function(){var e=Object(l.a)(o.a.mark((function e(r){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,t(s,m);case 3:n=e.sent,g(!n),i(""),x("");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){r&&y("/redirect")}),[r,y]),Object(p.jsxs)("section",{className:"flex md:flex-row flex-col text-center items-center md:justify-around justify-center min-h-screen gap-6 bg-white",children:[Object(p.jsx)("div",{className:"md:block hidden w-5/12",children:Object(p.jsx)("img",{className:"rounded-lg shadow-2xl w-full h-auto",src:w,alt:"Harbor Landscape"})}),Object(p.jsxs)("main",{className:"flex flex-col md:w-5/12 w-3/4 md:p-4 p-1 md:my-auto my-2 bg-white",children:[Object(p.jsx)("p",{className:"md:text-2xl text-xl font-bold md:m-3 mx-3 mb-3 mt-1",children:"Sign in to your account"}),Object(p.jsxs)("div",{className:"divide-y divide-gray-400",children:[Object(p.jsxs)("form",{onSubmit:k,className:"text-center bg-white md:w-4/5 w-full md:pb-6 pb-2 mx-auto",children:[f&&Object(p.jsx)("p",{className:"w-full rounded-lg p-2 mt-3 mb-6 text-center text-white font-roboto bg-red-700 select-none",children:"Try again"}),Object(p.jsx)("p",{className:"text-left my-2",children:"Username"}),Object(p.jsx)("input",{className:"rounded-lg w-full mb-2 p-2 bg-gray-300",type:"text",value:s,placeholder:"Enter your username",onChange:function(e){return N(e,i)}}),Object(p.jsx)("p",{className:"text-left mb-2",children:"Password"}),Object(p.jsx)("input",{className:"rounded-lg w-full mb-2 p-2 bg-gray-300",type:"password",placeholder:"Enter your password",onChange:function(e){return N(e,x)},value:m}),Object(p.jsx)("button",{className:"rounded-lg md:px-20 px-16 py-2 md:my-6 mb-4 mt-1 transition duration-300 ease-in-out bg-blue-200 hover:bg-blue-300",children:"Sign In"})]}),Object(p.jsx)("p",{className:"font-bold md:text-2xl text-xl md:py-8 pt-4 text-gray-300",children:"theforum."})]})]}),Object(p.jsx)("div",{className:"md:hidden md:w-5/12 w-4/6",children:Object(p.jsx)("img",{className:"rounded-lg shadow-2xl w-full h-auto",src:w,alt:"Harbor Landscape"})})]})},N=r(21);var k=function(e){var t=v(),r=Object(j.g)();return Object(p.jsx)("div",{className:"menu-item h-10 items-center text-center rounded-lg p-2 hover:bg-gray-300 cursor-pointer",children:"/login"===e.to?Object(p.jsx)("div",{onClick:function(e){e.preventDefault(),t.logout(),r("/login")},children:e.children}):Object(p.jsx)(N.b,{to:e.to,children:e.children})})};var S=function(e){var t=e.options;return Object(p.jsx)("div",{className:"dropdown absolute right-0 mx-3 w-40 p-3 bg-gray-100 border-2 border-black rounded-lg z-50",children:Object(p.jsx)("div",{children:t.map((function(e){return Object(p.jsx)(k,{to:e.to,children:e.title})}))})})},C=r.p+"static/media/logo.77209732.png";var E=function(e){return Object(p.jsx)("nav",{className:"h-14 bg-blue-100 border-2 border-black rounded-b-lg",children:Object(p.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[Object(p.jsx)("div",{className:"h-14",children:Object(p.jsx)("img",{className:"p-3 h-full",src:C,alt:"navbar_logo"})}),Object(p.jsx)("p",{className:"text-xl font-bold",children:"theforum."}),Object(p.jsx)("div",{className:"h-14",children:Object(p.jsxs)("ul",{className:"p-3 h-full",children:[" ",e.children," "]})})]})})},_=r(114),P=r(118),T=r(124),F=r(119);var I=function(e){var t=e.image,r=e.title,n=e.description,c=e.user;return Object(p.jsx)("div",{className:"post flex max-w-4xl bg-white mx-auto rounded-lg mt-6 mb-1 border-2 border-black p-3",children:Object(p.jsxs)("div",{className:"post_header w-full",children:[Object(p.jsxs)(_.a,{children:[Object(p.jsx)(P.a,{children:Object(p.jsx)(T.a,{className:"post_avatar my-4",src:"https://source.unsplash.com/random",alt:"User"})}),Object(p.jsx)(F.a,{primary:c,secondary:r})]}),Object(p.jsx)("h3",{className:"mx-3 -mt-0 mb-4",children:n}),Object(p.jsx)("div",{className:"max-w-4xl flex justify-center",children:Object(p.jsx)("img",{className:"post_img rounded-lg",src:t,alt:"Post pic"})})]})})},L=r(61),z=r.n(L),U=r(60),V=r.n(U),B=r(62),G=r.n(B);var J=function(){return Object(p.jsxs)("div",{className:"flex justify-between items-center max-w-4xl mx-auto border-2 border-black rounded-lg bg-gray-100 divide-x divide-black",children:[Object(p.jsxs)("div",{className:"flex items-center space-x-1 hover:bg-gray-100 flex-grow justify-center p-2 rounded-l-lg cursor-pointer hover:bg-gray-300",children:[Object(p.jsx)(V.a,{className:"h-4"}),Object(p.jsx)("p",{className:"text-xs sm:text-base",children:"favorite"})]}),Object(p.jsxs)("div",{className:"flex items-center space-x-1 hover:bg-gray-100 flex-grow justify-center p-2 cursor-pointer hover:bg-gray-300",children:[Object(p.jsx)(z.a,{className:"h-4"}),Object(p.jsx)("p",{className:"text-xs sm:text-base",children:"add comment"})]}),Object(p.jsxs)("div",{className:"flex items-center space-x-1 hover:bg-gray-100 flex-grow justify-center rounded-r-lg p-2 cursor-pointer hover:bg-gray-300",children:[Object(p.jsx)(G.a,{className:"h-4"}),Object(p.jsx)("p",{className:"text-xs sm:text-base",children:"like"})]})]})},A=r(48),D=r(121),H=r(120);var M=function(e){var t=e.comment,r=t.description,n=t.user.username;return Object(p.jsx)("div",{className:"max-w-4xl mx-auto",children:Object(p.jsxs)(H.a,{className:"w-full inline max-w-sm",children:[Object(p.jsxs)(_.a,{alignItems:"flex-start",children:[Object(p.jsx)(P.a,{children:Object(p.jsx)(T.a,{alt:"user",src:"https://source.unsplash.com/random"})}),Object(p.jsx)(F.a,{primary:n,secondary:Object(p.jsx)(c.a.Fragment,{children:Object(p.jsxs)(A.a,{component:"span",variant:"body2",className:"inline",color:"textPrimary",children:[" ",r]})})})]}),Object(p.jsx)(D.a,{variant:"inset",component:"li"})]})})},q=r(63),K=r.n(q),Q=r(123),R=r(122);var W=function(){return Object(p.jsxs)("form",{className:"postComment_box flex max-w-4xl mx-auto mt-5 mb-20 p-2",children:[Object(p.jsx)(Q.a,{label:"add comment",size:"small",variant:"outlined",className:"post_input flex-1"}),Object(p.jsx)(R.a,{className:"animate-none",variant:"contained",size:"small",endIcon:Object(p.jsx)(K.a,{})})]})},X=r(33),Y=r.n(X),Z=function(){var e=Object(l.a)(o.a.mark((function e(t,r,n){var c,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://posts-pw2021.herokuapp.com/api/v1/post","/all?limit=").concat(t,"&page=").concat(r),{method:"GET",headers:{Authorization:"Bearer ".concat(n)}});case 2:return c=e.sent,e.next=5,c.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),$=function(e){return e||null},ee=function(){var e=Object(l.a)(o.a.mark((function e(t,r,n){var c,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(t,r,n);case 2:return c=e.sent,a=c.data.map((function(e){return $(e)})),console.log(a),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),te=ee;function re(e){var t=Object(n.useState)(!1),r=Object(u.a)(t,2),c=r[0],a=r[1];return Object(p.jsxs)("li",{className:"nav-item",children:[Object(p.jsx)("a",{className:"icon-button cursor-pointer",onClick:function(){return a(!c)},children:e.icon}),c&&Object(p.jsx)(S,{options:[{title:"View all",to:"/user"},{title:"Favorites",to:"/favorites"},{title:"Logout",to:"/login"}]})]})}function ne(e){var t=e.post,r=t.title,n=t.description,c=t.image,a=t.user,s=t.comments;return Object(p.jsxs)("div",{children:[Object(p.jsx)(I,{title:r,description:n,image:c,user:a.username}),Object(p.jsx)(J,{}),s.map((function(e){return Object(p.jsx)(M,{comment:e})})),Object(p.jsx)(W,{})]})}var ce=function(){var e=Object(n.useState)([]),t=Object(u.a)(e,2),r=t[0],c=t[1],a=Object(n.useState)({page:0,limit:10}),s=Object(u.a)(a,2),i=s[0],o=(s[1],v().token);return Object(n.useEffect)((function(){var e=i.page,t=i.limit;te(t,e,o).then((function(e){return c(e)}))}),[]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(E,{children:Object(p.jsx)(re,{icon:Object(p.jsx)(Y.a,{}),children:Object(p.jsx)(S,{})})}),r.map((function(e){return Object(p.jsx)(ne,{post:e},e._id)}))]})};function ae(e){var t=Object(n.useState)(!1),r=Object(u.a)(t,2),c=r[0],a=r[1];return Object(p.jsxs)("li",{className:"nav-item",children:[Object(p.jsx)("a",{className:"icon-button cursor-pointer",onClick:function(){return a(!c)},children:e.icon}),c&&Object(p.jsx)(S,{options:[{title:"View all",to:"/user"},{title:"Favorites",to:"/favorites"},{title:"Logout",to:"/login"}]})]})}function se(e){var t=e.post,r=t.title,n=t.description,c=t.image,a=t.user;return Object(p.jsx)("div",{children:Object(p.jsx)(I,{title:r,description:n,image:c,user:a.username})})}var ie=function(){var e=Object(n.useState)([]),t=Object(u.a)(e,2),r=t[0],c=t[1],a=Object(n.useState)({page:0,limit:10}),s=Object(u.a)(a,2),i=s[0],o=(s[1],v().token);return Object(n.useEffect)((function(){var e=i.page,t=i.limit;te(t,e,o).then((function(e){return c(e)}))}),[]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(E,{children:Object(p.jsx)(ae,{icon:Object(p.jsx)(Y.a,{}),children:Object(p.jsx)(S,{})})}),r.map((function(e){return Object(p.jsx)(se,{post:e},e._id)}))]})};function oe(e){var t=Object(n.useState)(!1),r=Object(u.a)(t,2),c=r[0],a=r[1];return Object(p.jsxs)("li",{className:"nav-item",children:[Object(p.jsx)("a",{className:"icon-button cursor-pointer",onClick:function(){return a(!c)},children:e.icon}),c&&Object(p.jsx)(S,{options:[{title:"Create",to:"/create"},{title:"View my posts",to:"/mine"},{title:"View all",to:"/admin"},{title:"Logout",to:"/login"}]})]})}function le(e){var t=e.post,r=t.title,n=t.description,c=t.image,a=t.user;return Object(p.jsx)("div",{children:Object(p.jsx)(I,{title:r,description:n,image:c,user:a.username})})}var ue=function(){var e=Object(n.useState)([]),t=Object(u.a)(e,2),r=t[0],c=t[1],a=Object(n.useState)({page:0,limit:10}),s=Object(u.a)(a,2),i=s[0],o=(s[1],v().token);return Object(n.useEffect)((function(){var e=i.page,t=i.limit;te(t,e,o).then((function(e){return c(e)}))}),[]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(E,{children:Object(p.jsx)(oe,{icon:Object(p.jsx)(Y.a,{}),children:Object(p.jsx)(S,{})})}),r.map((function(e){return Object(p.jsx)(le,{post:e},e._id)}))]})},je=r.p+"static/media/errores.36ce7ca5.png",be=function(){var e=Object(j.g)();return Object(p.jsxs)("div",{className:"flex flex-col justify-center items-center w-screen h-screen bg-gray-100 ",children:[Object(p.jsx)("img",{className:"w-48",src:je,alt:"404"}),Object(p.jsx)("h2",{className:" text-xl font-roboto text-center",children:"Page not found"}),Object(p.jsx)("button",{className:"rounded-lg md:px-20 px-16 py-2 md:my-6 mb-4 mt-1 transition duration-300 ease-in-out bg-blue-200 hover:bg-blue-300",onClick:function(t){e("/login")},children:"Go to Login"})]})},de={admin:"/admin",user:"/user"},me=function(){var e,t=v().user;return t?Object(p.jsx)(j.a,{replace:!0,to:null!==(e=de[t.role])&&void 0!==e?e:"/"}):Object(p.jsx)("p",{children:" No se puede redireccionar "})},xe=function(e){var t=e.role,r=e.children,n=v(),c=n.token,a=n.user;return c?a&&a.role===t?r:Object(p.jsx)(j.a,{replace:!0,to:"/404"}):Object(p.jsx)(j.a,{replace:!0,to:"/login"})};var pe=function(){return Object(p.jsx)(N.a,{children:Object(p.jsxs)(j.d,{children:[Object(p.jsx)(j.b,{path:"/",element:Object(p.jsx)(j.a,{replace:!0,to:"/login"})}),Object(p.jsx)(j.b,{path:"/login",element:Object(p.jsx)(y,{})}),Object(p.jsx)(j.b,{path:"/redirect",element:Object(p.jsx)(me,{})}),Object(p.jsx)(j.b,{path:"/user",element:Object(p.jsxs)(xe,{role:"user",children:[" ",Object(p.jsx)(ce,{})," "]})}),Object(p.jsx)(j.b,{path:"/favorites",element:Object(p.jsxs)(xe,{role:"user",children:[" ",Object(p.jsx)(ie,{})," "]})}),Object(p.jsx)(j.b,{path:"/admin",element:Object(p.jsx)(xe,{role:"admin",children:Object(p.jsx)(ue,{})})}),Object(p.jsx)(j.b,{path:"/404",element:Object(p.jsx)(be,{})})]})})};s.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(f,{children:Object(p.jsx)(pe,{})})}),document.getElementById("root"))}},[[87,1,2]]]);
//# sourceMappingURL=main.0ae0e5cb.chunk.js.map